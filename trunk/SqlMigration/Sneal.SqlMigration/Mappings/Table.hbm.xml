<?xml version="1.0"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="Sneal.SqlMigration" namespace="Sneal.SqlMigration.Impl">
  
  <class name="Table">
    <id name="Name" column="Name">
      <generator class="increment"/>
    </id>
    <property name="Schema" column="Schema" not-null="true"/>
    <bag name="Columns" lazy="false" fetch="subselect">
      <key column="TABLE_NAME"/>
      <one-to-many class="Column"/>
      <loader query-ref="Column"/>
    </bag>
    <loader query-ref="Table"/>
  </class>
  
  <sql-query name="Table">
    <return alias="tbl" class="Table" lock-mode="none"/>
    SELECT t.TABLE_SCHEMA as {tbl.Schema}, t.TABLE_NAME as {tbl.Name}
    FROM information_schema.tables t
    WHERE t.TABLE_NAME=?
  </sql-query>
  
</hibernate-mapping>